---
import Layout from '../layouts/Layout.astro';
import EventCard from '../components/EventCard.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

import treeImg from '../assets/images/tree.png';
import slothImg from '../assets/images/sloth.png';
import tukiImg from '../assets/images/tuki.png';
import sloth2Img from '../assets/images/sloth2.png';

const events = await getCollection('events');
// Sort by date ascending
const sortedEvents = events.sort((a, b) => a.data.date.valueOf() - b.data.date.valueOf());
---

<Layout title="ראשי">
    <section class="hero">
        <div class="container hero-content">
            <h1>הבית הישראלי שלכם בקוסטה ריקה</h1>
            <p>מוזמנים להצטרף אלינו לפעילויות, ארוחות שבת, סדנאות ועוד בלב פוארטו ויאחו.</p>
            <a href="#schedule" class="button button-primary cta-button">ללוח האירועים שלנו</a>
        </div>
        <div class="hero-overlay"></div>
    </section>

    <section id="about" class="about-section">
        <div class="container about-container">
            <div class="about-text">
                <h2>אודותינו</h2>
                <p>
                    ברוכים הבאים לבית קהילת BINA בפוארטו ויאחו, המרכז המחבר בין טבע עוצר נשימה בקוסטה ריקה
                    לאווירה של בית ישראלי ויהודי חם. אנו מזמינים תיירים, מתנדבים וחברי קהילה לקחת חלק בעשייה,
                    שמירת השבת וארוחות משותפות. חוויה שכולה חיבור, התחדשות, ונתינה באווירה קסומה.
                </p>
            </div>
            <div class="about-images">
                <Image src={slothImg} alt="Sloth in Puerto Viejo" class="about-img main-about-img" />
                <Image src={tukiImg} alt="Toucan Bird" class="about-img secondary-about-img" />
            </div>
        </div>
    </section>

    <section id="schedule" class="schedule-section">
        <div class="container">
            <h2>לוח אירועים שבועי</h2>
            <div class="events-grid">
                {sortedEvents.length > 0 ? (
                    sortedEvents.map(event => (
                        <EventCard event={event} />
                    ))
                ) : (
                    <p>לא נמצאו אירועים קרובים כרגע.</p>
                )}
            </div>
        </div>
    </section>

    <section id="shabbat-passover" class="shabbat-section">
        <div class="container shabbat-container">
            <div class="shabbat-image-wrapper">
                 <Image src={sloth2Img} alt="Costa Rican Sloth" class="shabbat-img" />
            </div>
            <div class="shabbat-content">
                <h2>שבת וחגים בבית BINA</h2>
                <p>
                    מזמינים אתכם לחגוג איתנו את השבת ואת חגי ישראל (כולל פסח מתקרב!) באווירה המיוחדת של קוסטה ריקה.
                    אנא הירשמו מראש כדי שנוכל להיערך בהתאם.
                </p>
                <div class="shabbat-actions">
                    <a href="https://example.com/shabbat-payment" class="button button-primary" target="_blank" rel="noopener noreferrer">הזמנת ארוחת שבת</a>
                    <a href="https://example.com/passover-payment" class="button" target="_blank" rel="noopener noreferrer">הרשמה לפסח</a>
                </div>
            </div>
        </div>
    </section>
</Layout>

<style>
    .hero {
        position: relative;
        background-color: var(--color-jungle-green);
        min-height: 80vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        color: var(--color-white);
        margin-block-start: -1px; /* Overlap header box-shadow */
        overflow: hidden;
    }

    .hero-bg-image {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 0;
    }

    .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(46, 79, 43, 0.75); /* Jungle green with opacity */
        z-index: 1;
    }

    .hero-content {
        position: relative;
        z-index: 2;
        max-width: 800px;
    }

    .hero h1 {
        font-size: 2.5rem;
        margin-block-end: 1rem;
        color: var(--color-white);
        line-height: 1.2;
    }

    .hero p {
        font-size: 1.25rem;
        margin-block-end: 2rem;
    }

    .cta-button {
        font-size: 1.25rem;
        padding: 1rem 2rem;
    }

    .about-section {
        padding-block: 5rem;
        background-color: var(--color-white);
    }

    .about-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 3rem;
        align-items: center;
    }

    @media (min-width: 900px) {
        .about-container {
            grid-template-columns: 1fr 1fr;
        }
    }

    .about-text h2 {
        font-size: 2rem;
        margin-block-end: 1.5rem;
    }

    .about-text p {
        font-size: 1.15rem;
        line-height: 1.7;
        color: var(--color-text);
    }
    
    .about-images {
        position: relative;
        min-height: 350px;
    }

    .about-img {
        border-radius: 12px;
        box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        object-fit: cover;
    }

    .main-about-img {
        width: 80%;
        height: 300px;
        position: relative;
        z-index: 2;
    }

    .secondary-about-img {
        position: absolute;
        width: 60%;
        height: 250px;
        bottom: 0;
        inset-inline-end: 0; /* Logical property for right side in RTL */
        z-index: 1;
        transform: translate(-10%, 10%);
        border: 4px solid var(--color-white);
    }

    .schedule-section {
        padding-block: 4rem;
        background-color: var(--color-sand-light);
    }

    .events-grid {
        display: grid;
        gap: 2rem;
        grid-template-columns: 1fr;
    }

    @media (min-width: 768px) {
        .events-grid {
            grid-template-columns: repeat(2, 1fr);
        }
        .hero h1 {
            font-size: 3.5rem;
        }
    }
    
    @media (min-width: 1024px) {
        .events-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    .shabbat-section {
        padding-block: 5rem;
        background-color: var(--color-warm-wood);
        color: var(--color-white);
    }
    
    .shabbat-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 3rem;
        align-items: center;
    }

    @media (min-width: 900px) {
        .shabbat-container {
            grid-template-columns: auto 1fr;
        }
    }

    .shabbat-image-wrapper {
        text-align: center;
    }

    .shabbat-img {
        width: 100%;
        max-width: 400px;
        height: auto;
        border-radius: 50%;
        border: 6px solid rgba(255,255,255,0.2);
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        object-fit: cover;
        aspect-ratio: 1;
    }

    .shabbat-content {
        text-align: start;
    }
    
    @media (max-width: 899px) {
        .shabbat-content {
            text-align: center;
        }
        .shabbat-actions {
            justify-content: center;
        }
    }

    .shabbat-section h2 {
        color: var(--color-white);
        font-size: 2.2rem;
        margin-block-end: 1rem;
    }

    .shabbat-content p {
        font-size: 1.15rem;
        max-width: 600px;
        margin-block-end: 2rem;
        line-height: 1.6;
    }

    .shabbat-actions {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
    }
    
    /* Ensure the non-primary button in Shabbat section stands out better on wood bg */
    .shabbat-actions .button:not(.button-primary) {
        background-color: var(--color-sand);
        color: var(--color-text);
        text-decoration: none;
    }
    .shabbat-actions .button:not(.button-primary):hover {
        background-color: var(--color-white);
        text-decoration: none;
    }
</style>
